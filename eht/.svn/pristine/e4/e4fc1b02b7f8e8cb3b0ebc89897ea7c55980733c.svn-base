<%@page import="com.eht.common.constant.ActionName"%>
<%@ page language="java" contentType="text/html; charset=utf-8"
    pageEncoding="UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions"%>
<%@ taglib prefix="fmt" uri="http://java.sun.com/jstl/fmt_rt"%>
<%@ taglib prefix="xd" uri="http://www.xd-tech.com.cn/" %>
<%
	String path = request.getContextPath();
	String basePath = request.getScheme()+"://"+request.getServerName()+":"+request.getServerPort() + path;
	String frontPath = basePath + "/webpage/front";
	String cssPath = basePath + "/webpage/front/css";
	String imgPath = basePath + "/webpage/front/images";
	String uploadifyPath = basePath + "/webpage/front/js/uploadify";
	String sessionId = pageContext.getSession().getId();
%>
<c:set var="webRoot" value="<%=basePath%>" />
<c:set var="frontPath" value="<%=frontPath%>" />
<c:set var="cssPath" value="<%=cssPath%>" />
<c:set var="imgPath" value="<%=imgPath%>" />
<c:set var="uploadifyPath" value="<%=uploadifyPath%>" />
<c:set var="sessionId" value="<%=sessionId%>" />
<style>
<!--
li.over {background-color: #bcd4ec;}   
-->
</style> 
<script type="text/javascript"> 
	window.UEDITOR_HOME_URL = "${frontPath}/js/ueditor/";
	window.UEDITOR_IMG_URL = "${webRoot}";
	window.DOWNLOAD_URL = "${webRoot}/noteController/front/downloadNodeAttach.dht";
	var webRootUR = "${webRoot}";
	var uploadifyPath = "${uploadifyPath}";
	var imgPath = "${imgPath}";
</script>
<script type="text/javascript" charset="utf-8" src="${frontPath}/js/ueditor/ueditor.config.js"></script>
<script type="text/javascript" charset="utf-8" src="${frontPath}/js/ueditor/ueditor.all.min.js"> </script> 
<!--建议手动加在语言，避免在ie下有时因为加载语言失败导致编辑器加载失败-->
<!--这里加载的语言文件会覆盖你在配置项目里添加的语言类型，比如你在配置项目里配置的是英文，这里加载的中文，那最后就是中文-->
<script type="text/javascript" charset="utf-8" src="${frontPath}/js/ueditor/lang/zh-cn/zh-cn.js"></script>
<!-- 附件上传 -->
<link rel="stylesheet" type="text/css" href="${uploadifyPath}/uploadify.css" />
<script type="text/javascript" src="${uploadifyPath}/jquery.uploadify.v2.1.4.min.js" charset="utf-8"></script>
<script type="text/javascript" src="${uploadifyPath}/uploadify_api.js" charset="utf-8"></script>
<script type="text/javascript" src="${uploadifyPath}/swfobject.js"></script>
<script type="text/javascript" charset="utf-8" src="${frontPath}/js/notecontent.js"></script>
<!-- Begin function-->
	<form id="noteForm" name="noteForm" action="${webRoot}/noteController/front/saveNote.dht" method="post">
		<input type="hidden" id="noteForm_id" name="id" value="${id}"/>
		<input type="hidden" id="noteForm_subjectId" name="subjectId" value="${subjectId}"/>
		<input type="hidden" id="noteForm_dirId" name="dirId" value="${dirId}"/>
		<input type="hidden" id="noteForm_tagId" name="tagId" value="${tagId}"/>
		<input type="hidden" id="noteForm_version" name="version" value="${version}"/> 
		<input type="hidden" id="sessionId" name="sessionId" value="${sessionId}"/> 
      <div class="function" id="_more">
        <div class="left1">
          <input class="Button2" style="width:82px" onclick="addNewNote()" type="button" name="note_new" id="note_new" value="+ 新建条目" />
          <input class="Button1" type="button" name="saveNote_btn" id="saveNote_btn" onclick="saveNote()" value="保存" style="display:none;"/>
          <input class="Button4" type="button" name="note_edit" id="note_edit" onclick="enableEditNote()" value="编辑条目" />
          <input style="display:none;" class="Button2" type="button" name="restoreNote_btn" id="restoreNote_btn" onclick="restoreNote()" value="还原" />
          <input class="Button4" type="button" name="note_share" id="note_share" onclick="shareNote()" value="分享" />
          <input class="Button4" type="button" name="note_blacklist" id="note_blacklist" onclick="noteblacklist()" value="黑名单" />
        </div>
        <div class="others">
          <input class="Button3" type="button" onclick="deleteNote()" name="deleteNote_btn" id="deleteNote_btn" value="删除" />
          <!-- <input class="Button5" type="button" name="historyNote_btn" id="historyNote_btn" onclick="historyNote()" value="历史版本" /> -->
        </div>
        <div class="clear"></div>
      </div>
      <!-- End function--> 
      <div style="overflow-x:hidden;overflow-y:scroll;position:relative;">
      <!-- Begin new_edit-->
      <div class="new_edit" id="new_edit">
        <div class="title">
          <div class="left" style="margin-top:-5px;width:60%;">
          	<input id="noteTitleField" class="InputTxt3" type="text" value="${title}" name="title" style=" width:100%;line-height:29px;" maxlength="200">
          </div>
           <div class="clear"></div>
        </div> 
        <div class="title">
          <div class="left" style="font-size:14px;">位置：<span id="noteSubjectName"></span><span id="noteDirName"></span> </div>
          <div class="clear"></div>
        </div>
        <div class="Edit">
          <div style="font-size:12px;text-decoration:none;color: rgb(0, 99, 220);">
		        <div class="Edit_others">
			       <span>
			       	  <img src="${imgPath}/tag.png" id="selectTag" onclick="selectTagTree()"  style="cursor:pointer;"  />
			          <span id="tagSelectNode" ></span>
			       </span>
		        </div>
			    <div id="tagSelectContent" hidefocus="true" class="menuContent" style="background:#FFFFFF;font-size:13px;border: 1px solid rgb(190, 190, 190);display:none; position: absolute;z-index:1001">
					<ul id="tagSelectTree"  hidefocus="true" class="tag_tree" style="margin-top:0; width:186px;z-index:1002"></ul>
						<div class="rightMenu" id="tagSelectTreeRightMenu">
				        		<ul id="tagSelectTreeRightMenu_ul_tag">
				       				<li id="tagSelectTreeRightMenu_add_tag" onclick="tagaddChildTag()">添加标签</li>
				       				<li id="tagSelectTreeRightMenu_rename_tag" onclick="tagRenameNode()">修改标签</li>
				       				<li id="tagSelectTreeRightMenu_delete_tag" onclick="tagDeleteNode()">删除</li>
				        		</ul>
		        	   </div> 
				</div>
          </div>
        <div class="Edit_input">
          <script id="note_editor" name="content" type="text/plain" style="width:100%;height:700px;"></script>
        </div>
        </div>
      </div>
        <div class="Edit_others"  id="edit_attachment" style="padding-top:10px;padding-right:0px;padding-left:0px;">
   	  	    <div id="attachment" style="line-height:16px;height:20px;"><img src="${imgPath}/attachment.png" /></div>
   	  	    <div id="attachmentListDiv" style="padding-top:5px;"></div>
	  	</div>
      <!-- End new_edit--> 
      <!-- Begin comments-->
      <div class="comments" id="comments_div" style="height:40px;display:none;">
        <div class="top" style="cursor:pointer;" ><img src="${imgPath}/comments1a.png" id="comment_img" onclick="togComment()" height="35px"/></div>
        <div class="comments_list" style="display:none;" id="comments_list"></div>
      </div>
      <!-- End comments--> 
      </div>
    <!-- End notes_new-->
    <div class="clear"></div>
	</form>
	<div id="emailMsgDiv" style="font-size:14px;color: rgb(68, 68, 68);display:none;z-index:10001;background:#FFFFFF;border:1px solid rgb(213, 213, 213);width: 300px;position: absolute;top: 0px;left: 0px;">
	    <ul style="display:none;" class="floattishi" id="flttishi" ></ul>
		<input type="hidden" name="prevTrIndex" id="prevTrIndex" value="-1" />    
	</div>